<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test api</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>

</head>
<body>

<div id="jsonResponse">
    <button onclick="hideResult();">Hide result</button>
    <pre id="formatText">
    </pre>
</div>

<div class="testUsual">
    URL:
    <select id = "path">
        <option>/api/v1/json/users/loggedin</option>
        <option>/api/v1/json/priorities</option>
        <option>/api/v1/json/categories</option>
        <option>/api/v1/json/statuses</option>
        <option>/api/v1/json/persons</option>
        <option>/api/v1/json/pupils</option>
        <option>/api/v1/json/incidents</option>
        <option>/api/v1/json/issues</option>
        <option>/api/v1/json/activities</option>
        <option>/api/v1/json/activities/attach</option>
    </select>
    <br/>
    <br/>
    {id}
    <input id="idOf" value="/">
    (if not need, not delete "/")
    <br/>
    <br/>
    HTTP Method:
    <select id = "typeMethod">
        <option>GET</option>
        <option>POST</option>
        <option>PUT</option>
    </select>
    <br/>
    <br/>
    JSON data (suitable also with GET)
    <br/>
    <textarea id="jsonInput" cols=50 rows=30></textarea>
    <br/>
    <br/>

    <button id="requestBtn" onclick="makeRequest();">Send request</button>
    <br/>
    <br/>
    Working with file section:
    <br/>
    <form id="formUpload" action="" method="post" enctype="multipart/form-data">
        <input type="file" name="file">
        <br/>
        <button id="attachBtn" onclick="attachFile();">Attach file</button>
        <br/>

    </form>
    <button id="downloadBtn" onclick="downloadFile();">Download file</button>



</div>


<script>
    function makeRequest() {
        var URL = $('#idOf').val() == "/" ? $('#path').find(":selected").text()
                : $('#path').find(":selected").text() + $('#idOf').val();
        var typeMethod = $('#typeMethod').find(":selected").text();
        var $jsonInput = $('#jsonInput').val();
        var data = {};

        if ($jsonInput) {
            data = $.parseJSON($jsonInput);
        }

        $.ajax({
            url: '/ivis' + URL,
            contentType : typeMethod == 'GET' ? 'application/x-www-form-urlencoded; charset=UTF-8' : 'application/json; charset=utf-8' ,
            data: typeMethod == 'GET' ? data : JSON.stringify(data),
            type: typeMethod,
            cache: false,

            success: function (result) {
                var jsonResult = JSON.stringify(result, null, '\t');
                $('#formatText').text(jsonResult);
                $('#jsonResponse').show();
            }
        });
    }

    function attachFile() {
        var URL = $('#path').find(":selected").text() + $('#idOf').val();
        var typeMethod = $('#typeMethod').find(":selected").text().toLowerCase();

        var $form = $('#formUpload');
        $form.attr("action", URL);
        $form.attr("method", typeMethod);

        $form.submit();
    }


    function downloadFile() {
        var URL = $('#path').find(":selected").text() + $('#idOf').val();
        location.href = URL;
    }

    function hideResult() {
        $('#jsonResponse').hide();
    }

</script>

<style>
    #jsonResponse {
        float: right;
        display: none;
        width: 70%;
    }
</style>


</body>
</html>